
<% if flash[:notice] %>
  <p class="alert alert-primary text-center mx-auto my-2" role="alert"><%= flash[:notice]%></p>
<% end %>

<section class = "mt-5">
<div class = "container-md p-0">
<div class = "d-flex  align-items-center mb-3" >
  <h2 class = "m-0">予定一覧</h2>
  <%= link_to :new_post, class: "btn btn-primary ms-auto " do %>
    <i class="bi bi-plus-circle-fill me-1"></i>
    新規追加
  <% end %>
</div>
<table class = "table table-striped table-bordered">
  <thead>
    <tr>
      <th>ID</th>
      <th>タイトル</th>
      <th>開始日</th>
      <th>終了日</th>
      <th>終日</th>
      <th>更新日時</th>
    </tr>
  </thead>

  <tbody>
    <% @posts.each do |post| %>
      <tr class = "align-middle">
        <td><%= post.id %></td>
        <td><%= post.title %></td>
        <td><%= post.start_date.strftime("%Y/%m/%d") %></td>
        <td><%= post.end_date.strftime("%Y/%m/%d") %></td>
        <td class = "text-center"><%= post.all_day_existence ? "⚪︎":"" %></td>
        <td><%= post.updated_at.strftime("%Y/%m/%d %H:%M")  %></td>
        <td class = "text-center">
        <%= link_to "詳細", post ,class: "btn btn-outline-primary btn-sm " %>
        </td>
        <td class = "text-center">
        <%= link_to "編集", [:edit, post],class: "btn btn-outline-primary btn-sm" %>
        </td>
        <td class = "text-center">
          <!-- Button trigger modal -->
          <button type="button" class="btn btn-danger btn-sm " data-bs-toggle="modal" data-bs-target="#exampleModal">
          削除
          </button>
          <!-- Modal -->
          <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h1 class="modal-title fs-5" id="exampleModalLabel">予定の削除</h1>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  本当に削除しますか？
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">閉じる</button>
                  <%= link_to "削除",post, method: :delete, class: "btn btn-danger me-2" %>
                </div>
              </div>
            </div>
          </div>
        </td>        
      </tr>
    <% end %>
  </tbody>
</table>
</div>
</section>

<footer>
  <div class = "container-md d-flex align-items-center justify-content-between border-bottom border-primary-subtle p-0 ">
    <div class="fs-5 fw-semibold">予定合計 <%= @posts.count %>件</div>
    <div class = "text-black-50">本日の日付 <%= Time.zone.today.strftime("%Y/%m/%d") %></div>
  </div>
</footer>